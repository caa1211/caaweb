<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <!--common css-->
    <link href="../../../css/themes/custom-theme/jquery-ui-1.7.2.custom.css" rel="stylesheet" type="text/css"/>
    <link href="../../../css/themes/myCustom.css" rel="stylesheet" type="text/css"/>
    <link href="../../../css/demos.css" rel="stylesheet" type="text/css" />
    
    
    <!--common js-->
    <script src="../../../js/jquery-1.3.2.min.js" type="text/javascript"></script>
    <script src="../../../js/jquery-ui-1.7.2.custom.min.js" type="text/javascript"></script>
    <script src="../../../js/zyJqFunctions.js" type="text/javascript"></script>
   

<SCRIPT LANGUAGE="JavaScript">
function ExportExcel()
{
    var oXL =new ActiveXObject("Excel.Application"); //创建excel应用程序对象
   var oWB =oXL.Workbooks.Add();       //创建工作簿
    var oSheet =oWB.ActiveSheet;        //获取当前活动的工作簿
    var table =document.all.data;       //获取当前页面中的表格
    var hang =table.rows.length;        //获取表格有多少行
    var lie =table.rows(0).cells.length; //获取首行有多少列-多少标题

    for(i=0;i<hang;i++)              //添加标题到表格中
   {
      for (j=0;j<lie;j++)
      {
         oSheet.Cells(i+1,j+1).Value =table.rows(i).cells(j).innerText;  //设置标题的内容
      }
   }
   oXL.Visible = true;//设置Excel的属性
  oXL.UserControl = true;
}
</SCRIPT>

 

</head>
<body>

<input type="button" name="btnExcel"onclick="ExportExcel()" value="导出到excel"class="notPrint">
<table id="data" width="200"border="1">
<tr>
<td>姓名</td>
<td>年龄</td>
</tr>
<tr>
<td>张三</td>
<td>22</td>
</tr>
<tr>
<td>昂立</td>
<td>33</td>
</tr>
<tr>
<td>效力　</td>
<td>23</td>
</tr>
</table>



</body>
</html>
