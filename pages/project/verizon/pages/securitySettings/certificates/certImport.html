<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<link href="../../tabFW/css/tabs.css" rel="stylesheet" type="text/css" />
<link href="../../../css/brick.css" rel="stylesheet" type="text/css" />
<script src="../../../js/jquery-1.3.2.min.js" type="text/javascript"></script>
  <script src="../../../js/jquery.getParams.js" type="text/javascript"></script> 
  <script src="../../tabFW/js/jquery.tools.min_tab.js" type="text/javascript"></script>
  <script src="../../../js/jquery.validate.pack.js" type="text/javascript"></script>
  <script type="text/javascript" src="../../../js/jquery.simplemodal-1.3.min.js"></script>
  <script type="text/javascript" src="../../tabFW/js/loadingMask.js"></script>   
  <!--for RD-->
  <link type="text/css" href="../../../css/ui/no-theme/jquery-ui-1.7.2.custom.css" rel="stylesheet" />
  <script type="text/javascript" src="../../../js/ui/jquery-ui-1.7.2.custom.min.js"></script>
  <script type="text/javascript" src="../../../js/zyJqFunctions.js"></script>
  <script type="text/javascript" src="../../../js/zyUiDialog.js"></script>
  <script type="text/javascript" src="../../../js/baseJS.js"></script>
  <script type="text/javascript" src="../../../js/general.js"></script>  
  <script type="text/javascript" src="../../../js/util.js"></script> 
<script language="javascript">
<!-- hide

var keystart = '-----BEGIN RSA PRIVATE KEY-----';
var keyinsert = '\n<insert private key here>\n';
var keyend = '-----END RSA PRIVATE KEY-----';
var certstart = '-----BEGIN CERTIFICATE-----';
var certinsert = '\n<insert certificate here>\n';
var certend = '-----END CERTIFICATE-----';
var sessionKey='<%ejGetOther(sessionKey)%>';
var certCategory='<%ejGet(certCategory)%>';

function showhide(element, sh)
{
    var status;
    if (sh == 1) {
        status = "block";
    }
    else {
        status = "none"
    }
        
	if (document.getElementById)
	{
		// standard
		document.getElementById(element).style.display = status;
	}
	else if (document.all)
	{
		// old IE
		document.all[element].style.display = status;
	}
	else if (document.layers)
	{
		// Netscape 4
		document.layers[element].display = status;
	}
}

function frmLoad() {

  document.importForm.action = 'certImport.cgi?certLocalAction=import&sessionKey=' + sessionKey;
  with ( document.forms[0] ) {
    certViewPriv.value = keystart + keyinsert + keyend + '\n';
    certViewContent.value = certstart + certinsert + certend + '\n';
  }
  
  if(certCategory=='ca'){
    showhide("hiddenCA", 0);
	}
}

function applyClick() {     
  with ( document.forms[0] ) {
    if ( certViewName.value == '' ) {
      alert('Certificate Name should not be empty.');
      return;
    }
    if(certCategory=='local'){
      if ( certViewPriv.value == '' ) {
        alert('Certificate Private Key should not be empty.');
        return;
      }
      if ( certViewContent.value == '' ) {
        alert('Certificate Public Key should not be empty.');
        return;
      }
    }
  }
  document.importForm.submit();
}

function backClick(){
	 var loc;
	 if(certCategory=='ca'){
	 	 window.parent.document.activePage('securitySettings-certificates', 1);
	 	 return;
	 }else if(certCategory=='local'){
	   loc = 'tabFW.html?tabJson=../securitySettings/certificates/tab.json';
	 }
	 var code = 'location="' + loc + '"';
	 eval(code);
}

// done hiding -->
</script>
</head>
<body onLoad='frmLoad()'>

<div class="unit_title" >Import certificate</div>
<ul class="redline"></ul>

<div class="content_frame" >
<!--Unit Explain start-->
<div class="explain">
<div><b class="r1"></b><b class="r2"></b><b class="r3"></b><b class="r4"></b><b class="r4"></b></div>
<div class="explain_text">
Enter certificate name, paste certificate content and private key.
</div>
<div><b class="r4"></b><b class="r4"></b><b class="r3"></b><b class="r2"></b><b class="r1"></b></div></div>
<!--Unit Explain End-->	


<form name="importForm" method="post">


<div class="data_frame"><ul>

<!--level 1 start--><li class="set1"> <div class="w_table">
  <!--Table define start--><table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" class="table_frame">
    <tr>
      <td><table width="100%" border="0" align="center" cellpadding="0" cellspacing="0">
        <tr>
          <td><table width="100%" border="0" align="center" cellpadding="0" cellspacing="0">
            <tr>
              <td><table width="100%" cellpadding="0" cellspacing="0" >

                <tr align="center">
                  <td valign="top" background="images/table_02_center.gif"><span class="top_font">Certificate Name:</span></td>
                  <td class="table_font">
                  	<input type='text' name='certViewName' size='20' maxlength="63">
                  </td>	
                </tr>

                <tr align="center">
                  <td valign="top" background="images/table_02_center.gif"><span class="top_font">Certificate:</span></td>
                  <td class="table_font">
                  	<TEXTAREA name='certViewContent' rows='20' cols='120'></TEXTAREA>
                  </td>	
                </tr>

                <tr id="hiddenCA" align="center">
                  <td valign="top" background="images/table_02_center.gif"><span class="top_font">Private Key:</span></td>
                  <td class="table_font">
                  	<TEXTAREA name='certViewPriv' rows='20' cols='120'></TEXTAREA>
                  </td>	
                </tr>
                
              </table></td>
            </tr>
          </table></td>
        </tr>
      </table></td>
    </tr>
  </table>
</div>
<!--Table define end-->
</li>
<!--level 1 end-->


<li class="space"> </li>

<!--Button define start-->
<li class="buttonframe"><div class="button_position">
  <input type='button' value='Apply' onClick="applyClick()">
  &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
	<input type='button' value='&nbsp Back &nbsp' onClick="backClick();">
</div></li>
<!--Button define end-->


</ul></div>	
</form> 
<!--Set area end-->		
</div>

</body>
</html>
