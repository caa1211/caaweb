<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <!--common css-->
    <link href="../../../css/themes/custom-theme/jquery-ui-1.7.2.custom.css" rel="stylesheet" type="text/css"/>
    <link href="../../../css/themes/myCustom.css" rel="stylesheet" type="text/css"/>
    <link href="../../../css/demos.css" rel="stylesheet" type="text/css" />
    
    
    <!--common js-->
    <script src="../../../js/jquery-1.3.2.min.js" type="text/javascript"></script>
    <script src="../../../js/jquery-ui-1.7.2.custom.min.js" type="text/javascript"></script>
    <script src="../../../js/zyJqFunctions.js" type="text/javascript"></script>
   
    <script type="text/javascript">
  var oXL =new ActiveXObject("Excel.Application"); //创建excel应用程序对象
  var oWB =oXL.Workbooks.Add();       //创建工作簿
  var oSheet =oWB.ActiveSheet;        //获取当前活动的工作簿

        $(function()
        {
        $.getJSON('hostEvent.json', function(data){
        var cell_1 =  oSheet.Cells(1,1);//设置标题的内容
        var cell_2 = oSheet.Cells(1,2);
		var cell_3 =  oSheet.Cells(1,3);//设置标题的内容
        var cell_4 = oSheet.Cells(1,4);
        
		cell_1.Value ='category';  
		cell_2.Value ='key';  //设置标题的内容
        cell_3.Value ='formatOnVm';  //设置标题的内容
        cell_4.Value ='description';  //设置标题的内容
        
		cell_1.Font.Bold =true;   //加粗
		cell_2.Font.Bold =true;   //加粗
        cell_3.Font.Bold =true;   //加粗
        cell_4.Font.Bold =true;   //加粗
		
        cell_1.Borders(3).LineStyle = 1;
		cell_2.Borders(3).LineStyle = 1;
        cell_3.Borders(3).LineStyle = 1;
        cell_4.Borders(3).LineStyle = 1;
        
        cell_1.Interior.ColorIndex = 15;
		cell_2.Interior.ColorIndex = 15;
        cell_3.Interior.ColorIndex = 15;
        cell_4.Interior.ColorIndex = 15;

		
        function setHeader(data){
        var c = 0;

        
        $.each(data, function(k, v){
            c++;
            cell =  oSheet.Cells(1,c);//设置标题的内容
            cell.Value =k;  
            cell.Font.Bold =true;   //加粗
            cell.Borders(3).LineStyle = 1;
            cell.Interior.ColorIndex = 15;
        });
        
        }
		  
      var index=1;
      
   $.each(data, function(ii, dd){
   
          if(index==1){
            setHeader(dd);
          }
          
          index++;
          //oSheet.Cells(index,1).Value = index ; 
          oSheet.Cells(index,1).Value =dd.category; 
          oSheet.Cells(index,2).Value =dd.key;  
          oSheet.Cells(index,3).Value =dd.description; 
          oSheet.Cells(index,4).Value =dd.formatOnVm; 
          oSheet.Cells(index,5).Value =dd.fullFormat; 

		  })
  oXL.Visible = true;//设置Excel的属性
  oXL.UserControl = true;
   });
 
        });
  
    </script> 

</head>
<body>


 


</body>
</html>
