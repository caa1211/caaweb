<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <!--common css-->

    
    <!--common js-->
    <script src="jquery-1.3.2.min.js" type="text/javascript"></script>
   <script src="2.5.3-crypto-sha1-hmac.js" type="text/javascript"></script>
   <script src="webtoolkit.base64.js" type="text/javascript"></script>

    
    <script type="text/javascript">
	
    
        
        $(function()
        {
   
 
       var item_value = [{'Name':'testvm2'},
                         {'DataStoreName':'datastore1'},
                         {'DiskSize':'10240'},
                         {'GuestId':'winXPProGuest'},
                         {'HostName':'172.101.35.3'},
                         {'MemoryMB':'1024'},
                         {'NetworkName':'VM Network'},
                         {'NumCPUs':'1'}];
                         
                    var item_name = 'testvm';  
                    var module = 'createVMWareInstanceByName'
                    var params = JSON.stringify(item_value);
                    var item_status = 'true'
                    var raw = module + item_name + params;
                    var key = 'UPNEO/SG08KA4BUUsMhMEZlUEWzZQYJT/I8SFELeGSQ='
                    
                    var hmac = Crypto.HMAC(Crypto.SHA1, raw, key, { asString: true });			
                    var signature = Base64.encode(hmac);

                    var vdcm = 'http://140.96.29.85:8080/ccma-vdcm/webservice/vdcm?'
                    var query = {
                        accesskey : '7A092ACFA24A7B80CCFE',
                        signature : signature,
                        module : module,
                        item_name: item_name,
                        item_value : params,
                        response_type : '1'
                    };

                    var url = vdcm + JSON.stringify(query);
                    
             
               
             $("#btn").click(function(){
           //  debugger;
                               $.ajax({
                    url: url,
                    error: function(xhr) {
                    debugger;
                      alert('Ajax request 發生錯誤');
                     // $(e.target).attr('disabled', false);
                    },
                    success: function(response) {
                    alert("33")
                      $('#msg').html(response);
                      $('#msg').fadeIn();
                     
                    }
                  });
                  
  
             })  
               



        

        });
  
    </script> 

</head>
<body>
<div id='msg'></div>

 <button id="btn">ajax </button>
<!--web link-->
<br/><br/><br/>
<a href='aaaaa' 
class='ui-state-default ui-corner-all' 
target='_blank'>reference</a>


</body>
</html>
