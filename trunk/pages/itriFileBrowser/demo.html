<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <!--common css-->

    <link href="css/reset.css" rel="stylesheet" type="text/css" />
    <link href="css/itriFileBrowser.css" rel="stylesheet" type="text/css" />
    <link href="css/blue/style.css" rel="stylesheet" type="text/css" />
    <link href="css/ui-lightness/jquery-ui-1.8.19.custom.css" rel="stylesheet" type="text/css" />
    <!--common js-->
    <script src="js/jquery-1.7.2.min.js" type="text/javascript"></script>
    <script src="js/jquery.tablesorter.js" type="text/javascript"></script>
    <script src="js/jquery-ui-1.8.19.custom.min.js" type="text/javascript"></script>
   <script src="js/itriFileBrowser.js" type="text/javascript"></script>


    
    <script type="text/javascript">

        $(function()
        {
            var generator = {
             idCounter: 0,
             id: function(){
                 this.idCounter ++;
                 return this.idCounter;
             }
            }

            var mode = {
                select: false
            };
            
            function _L(str){
                console.log(str);
            }
            
            var sel = {
                first:null,
                last: null,
                addFirst : function(){
                    sel.first.addClass('select');
                },
                add : function(obj, dragFlag, updateLast){ 
                
                    if(dragFlag == undefined){
                        dragFlag = false;
                    }
                    if(updateLast== undefined){
                        updateLast = true;
                    }
                    if(dragFlag && ( $("#fileList tr.select").length == 0 && sel.first!=null));
                    {
                        sel.addFirst(); 
                    }                       
                    obj.addClass('select');
                    
                    if(updateLast!=false)
                     sel.last = obj;
                },
                clear: function(){  $("#fileList tr").removeClass('select'); },
                addRange: function(start,end){
                
              //  _L("range : " + start +" , " + end);
                   var e = start - end > 0 ? start: end;
                   var s = start - end > 0 ? end : start;
                    _L("range : " + s +" , " + e);
                    
                    for(var i=s; i<= e ; i++)
                    {
                     _L("i : " + i);
                  //  $("#fileList tr:nth-child("+i+")")
                     sel.add($("#fileList tr:nth-child("+i+")"), false, false);
                    }
                
                },
                onMouseup: function(e){  
                
                    $("#fileList tr").unbind('mouseenter', sel.onMouseenter);
                    $("#fileList tr").unbind('mouseup', sel.onMouseup);
                    mode.select = false;
                    
                    if (e.shiftKey && sel.last != null) { //select
                       sel.clear()
                       sel.addRange( $("#fileList tr").index(sel.last),  $("#fileList tr").index($(this)));
                       return;
                    }
                    
                    if($(this)[0]==sel.first[0])
                      sel.add($(this));

                    sel.first = null;
                    
                    //_L('last index:' +    $("#fileList tr").index(sel.last));
                }, 
                onMouseenter: function(){
                
                  if($(this)[0]==sel.first[0])
                    sel.clear();
                    
                    sel.add($(this));
                    
                },
                all: function(){
                  $("#fileList tr").addClass('select');
                }
            };
            

        	$("#fileList").tablesorter({debug: false});
                $("table tr").mouseleave(function(){
                $(this).removeClass('hover');
            });
            
                        
          
            var drag={
              onMouseup: function(){                    
              /*if($(this)[0]==drag.first[0])
                    { 
                        _L("tttttt")
                      sel.clear();
                    }
                       sel.add($(this));
                       
                          drag.first = null;*/
                      },
              first: null
            };
            
            
            //$("table tr:odd").addClass('odd')
            $("table tr").mouseenter(function(){
                $(this).addClass('hover');
                /*
                if(  mode.select )
                    {
                      sel.add($(this), true);
                    }*/
            })

   

            $("table tr").mousedown(function(e){
              
               // sel.first  = $(this);
              //  drag.first  = $(this);
               //  $("table tr").unbind('mouseup', sel.onMouseup);
               //  $("table tr").unbind('mouseup', drag.onMouseup);
                 
                 
                if($(this).hasClass('select')){//drag
                    mode.drag = true;
                 //  drag.init();
                    drag.first  = $(this);
                    $("table tr").bind('mouseup', drag.onMouseup);
                }
                else{//select
                    sel.first  = $(this);
                    mode.select = true;
                    if (e.ctrlKey) {
                    }
                    else{
                      sel.clear();
                    }

                    $("table tr").unbind('mouseup', sel.onMouseup);
                    $("table tr").unbind('mouseenter', sel.onMouseenter);
                    $("table tr").bind('mouseenter', sel.onMouseenter);
                    $("table tr").bind('mouseup', sel.onMouseup);
                    
                    e.preventDefault(); 
                }
            })
            
            $("table").click(function(){return false;})
            

            $(this).keydown(function(e,a){ 
                  if(e.which==65 && e.ctrlKey)
                    sel.all();
            });
            
            
            $(this).click(function(){sel.clear();});
            
            /*
            $('table').mousedown(function (e) {
                if (e.ctrlKey) {
                 alert('c')
                 e.preventDefault();
                }
                if (e.shiftKey) {
                alert('s')
                 e.preventDefault();
                }
                
            });*/


        });
  
    </script> 

    <style>
    
::selection {
	background: none; /* Safari */
	}
::-moz-selection {
	background: none; /* Firefox */
}
::-webkit-selection {
	background:none;
	/*color:none;*/
}


    .wrapDiv{border: solid 1px red; width:80%; margin:0 auto;}

    .fileList tbody tr.select td {
        background-color:#eaeaea;
    }
    .fileList tbody tr.hover td {
        background-color:#F0F0CC;
    }

    .fileList tbody tr span.type {
        background-color:#eaeaea;

    }
    
   .fileList tbody tr {  color: #000000; font-size: 13px;    line-height: 32px;}
        line-height: 32px;
    }
    
    .fileList tbody tr div.name{  color: #000000; font-size: 13px;   }
    
    .fileList.tablesorter tbody td {
        border-bottom: solid 1px #eaeaea;
    }
    
    
    .fileList.tablesorter tbody td {
        border-bottom: solid 1px #eaeaea;
    }
    
    .nameArea img {width:32px; height:32px; position: absolute;}
    .nameArea img.folder{}
    .nameArea img.file{}
    
    .nameArea .name{ margin-left: 40px;}
    </style>
</head>
<body>

<div class='wrapDiv'>
 <table id="fileList" class="tablesorter fileList"> 
<thead> 
<tr> 
    <th>Name</th> 
    <th>Size</th> 
    <th>LastModified</th> 

</tr> 
</thead> 
<tbody > 
<tr> 
    <td class='nameArea'><img src='imgs/folder2.png' class='folder'/><div class='name'>AA</div></td>
    <td>310.7 MB</td> 
    <td>--</td> 

</tr> 
<tr> 
     <td class='nameArea'><img src='imgs/folder2.png' class='folder'/><div class='name'>BB</div></td>
    <td>310.7 MB</td> 
    <td>--</td> 
</tr> 
<tr> 
     <td class='nameArea'><img src='imgs/folder2.png' class='folder'/></div><div class='name'>BB</div></td>
    <td>310.7 MB</td> 
    <td>--</td> 
</tr> 
<tr> 
     <td class='nameArea'><img src='imgs/folder2.png' class='folder'/><div class='name'>BB</div></td>
    <td>310.7 MB</td> 
    <td>--</td> 
</tr> 
<tr> 
      <td class='nameArea'><img src='imgs/file.png' class='file'/><div class='name'>CC</div></td>
    <td>310.7 MB</td> 
    <td>--</td> 

</tr> 
<tr> 
     <td class='nameArea'><img src='imgs/file.png' class='file'/><div class='name'>DD</div></td>
    <td>310.7 MB</td> 
    <td>--</td> 

</tr> 
</tbody> 
</table> 
</div>

</body>
</html>
